defaults.pcm.rate_converter "speexrate_best"

# Default `slave.pcm` ==========================================================
pcm.!default {
        type plug
        slave.pcm "duplex"
}

# Change `dsp` to either `bs2b` for the crossfeed effect or `dsp_bs2b`
# for the crossfeed + AutoEQ
pcm.duplex {
        type asym
        playback.pcm "dsp"
        capture.pcm "hw:U0x46d0x8c9"
}

# AutoEQ Plugin
pcm.dsp {
        type ladspa
        slave.pcm "dmixplug"
        path "/usr/lib/ladspa/"
        plugins [{
                label ladspa_dsp
        }]
}

# Add `dmix` to enable multi-application output, and avoid non-dmix enabled
# setup’s ‘Audio Resource is Busy’
pcm.dmixplug {
        type plug
        slave.pcm "dmixer"
}

# Replace `DSD` with your card’s name
pcm.dmixer {
        type dmix
        ipc_key 6969
        slave {
                pcm "hw:DSD"
                rate 44100
                format S32_LE

                # The following four settings (plus the usage of a
                # libspeex-derived resampler) seems to alleviate most issues
                # (including a sharp click upon playback resume after being
                # paused for some time e.g. Youtube playback) with chrome-based
                # browsers having audio glitches when resampling from 48000 to
                # 44100
                period_time 0
                buffer_time 0
                period_size 1024
                buffer_size 4096

                # If you’re using a chrome-based browser (e.g. Chrome and Brave)
                # and you still experience some occassional clicks during
                # playback, try adding the command line option
                # `--audio-buffer-size=2048`
        }
}
# ==============================================================================

# These are `slave.pcm` alternatives ===========================================
# Crossfeed Plugin
pcm.bs2b {
        type ladspa
        slave.pcm "dmixplug"
        path "/usr/lib/ladspa/"
        plugins [{
                label bs2b
                input {
                      controls [ 725 4.5 ]
                }
        }]
}

# Combined Crossfeed and AutoEQ Plugins
pcm.dsp_bs2b {
        type ladspa
        slave.pcm "dmixplug"
        path "/usr/lib/ladspa/"
        plugins [{
                label bs2b
                input {
                      controls [ 725 4.5 ]
                }
        }
                {
                label ladspa_dsp
        }]
}
# ==============================================================================
