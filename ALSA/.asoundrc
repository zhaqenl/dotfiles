defaults.pcm.rate_converter "speexrate_best"

# Default `slave.pcm` ==========================================================
pcm.!default {
        type plug
        slave.pcm "duplex"
}

# Change `dsp` to either `bs2b` for the crossfeed effect or `dsp_bs2b`
# for the crossfeed + AutoEQ
pcm.duplex {
        type asym
        playback.pcm "dsp"
        capture.pcm "hw:U0x46d0x8c9"
}

# AutoEQ Plugin
pcm.dsp {
        type ladspa
        slave.pcm "dmixplug"
        path "/usr/lib/ladspa/"
        plugins [{
                label ladspa_dsp
        }]
}

# Add `dmix` to enable multi-application output, and avoid non-dmix enabled
# setup’s ‘Audio Resource is Busy’
pcm.dmixplug {
        type plug
        slave.pcm "dmixer"
}

# Replace `DSD` with your card’s name
pcm.dmixer {
        type dmix
        ipc_key 6969
        slave {
                pcm "hw:DSD"
                format S32_LE

                # Default back to 48000 since everything works fine
                # (click/stutter/glitch-free audio) except for Viber having
                # these semi-regular audio stutters when rate is set to 44100,
                # probably due to the on-the-fly resampling
                rate 48000

                # If you’re using a chrome-based browser, and you plan to use
                # 44100 as your sample rate, tweak the following settings for
                # glitch-free playback (these placeholder values are actually
                # brave browser’s default and audio glitch-free values as seen
                # through my card’s `hw_params` while playing back on an `hw`
                # pcm.)
                # period_size 1024
                # buffer_size 4096

                # If you’re using a chrome-based browser (e.g. Chrome and Brave)
                # and you still experience some occassional clicks during
                # playback, try adding the command line option
                # `--audio-buffer-size=2048`
        }
}
# ==============================================================================

# These are `slave.pcm` alternatives ===========================================
# Crossfeed Plugin
pcm.bs2b {
        type ladspa
        slave.pcm "dmixplug"
        path "/usr/lib/ladspa/"
        plugins [{
                label bs2b
                input {
                      controls [ 725 4.5 ]
                }
        }]
}

# Combined Crossfeed and AutoEQ Plugins
pcm.dsp_bs2b {
        type ladspa
        slave.pcm "dmixplug"
        path "/usr/lib/ladspa/"
        plugins [{
                label bs2b
                input {
                      controls [ 725 4.5 ]
                }
        }
                {
                label ladspa_dsp
        }]
}
# ==============================================================================
